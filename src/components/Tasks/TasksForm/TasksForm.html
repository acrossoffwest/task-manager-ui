<BaseLayout>
	<span slot="header">{{ form.title || h1.main }}</span>
	<div slot="body" :class="`${$color('blocks')} rounded-lg`">
		<div class="lg:flex">
			<div class="lg:w-full h-full mt-5 p-5">
				<div :class="`bg-white pl-5 pr-5 h-full ${$color('blocks')}`">
					<div class="block w-3/4 float-left">
						<div class="mb-2">
							<input-field :value.sync="form.title" :errors="errors.title" type="text" placeholder="Enter task title"/>
						</div>
					</div>
					<DropdownMenu class="lg:hidden" :actions="getActions()"></DropdownMenu>
					<div class="hidden lg:block">
						<button v-if="!isCreate" @click="save"
										class="bg-blue-500 mr-5 hover:bg-blue-700 text-white font-bold py-2 px-4 rounded focus:outline-none focus:shadow-outline"
										type="button">
							Save
						</button>
						<button v-if="isCreate" @click="create"
										class="bg-orange-500 mr-5 hover:bg-orange-700 text-white font-bold py-2 px-4 rounded focus:outline-none focus:shadow-outline"
										type="button">
							Create
						</button>
						<button v-if="isCreate" @click="cancel"
										class="bg-gray-500 hover:bg-gray-700 text-white font-bold py-2 px-4 rounded focus:outline-none focus:shadow-outline"
										type="button">
							Cancel
						</button>
						<button v-else @click="goToCurrentTasks"
										class="bg-gray-500 hover:bg-gray-700 text-white font-bold py-2 px-4 rounded focus:outline-none focus:shadow-outline"
										type="button">
							Tasks
						</button>
					</div>
				</div>
			</div>
		</div>
		<div class="lg:flex">
			<div class="lg:w-1/2 h-full mt-5">
				<div :class="`${$color('blocks')} p-5 h-full`">
					<Countdown
						v-if="form.id && showCountdown"
						ref="countdown"
						:init-task="form"
						@toggle="toggleCountdown"
						@update:seconds="updateSeconds"
					/>
				</div>
			</div>
			<div class="lg:w-1/2 h-full mt-5 p-5">
				<div :class="`${$color('blocks')} px-5 pb-1 pt-5`">
					<div class="mb-2">
						<label for="parent-category" class="block text-sm font-bold mb-2">
							Parent category
						</label>
						<div class="relative mb-2">
							<input-field
								:value.sync="form.project_category_id"
								:options="parentCategories"
								option-value-key="id"
								option-name-key="title"
								:errors="errors.project_category_id"
								type="select"
								placeholder="Enter task title"
							/>
							<div class="pointer-events-none absolute inset-y-0 right-0 flex items-center px-2 ">
								<svg class="fill-current h-4 w-4" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 20 20">
									<path d="M9.293 12.95l.707.707L15.657 8l-1.414-1.414L10 10.828 5.757 6.586 4.343 8z"/>
								</svg>
							</div>
						</div>
					</div>
				</div>
				<div :class="`${$color('blocks')}  px-5 pb-1 pt-5`">
					<div class="mb-2">
						<label for="parent-category" class="block  text-sm font-bold mb-2">
							Status
						</label>
						<div class="relative mb-2">
							<input-field
								:value.sync="form.status"
								:options="statuses"
								:errors="errors.project_category_id"
								type="select"
							/>
							<div class="pointer-events-none absolute inset-y-0 right-0 flex items-center px-2 ">
								<svg class="fill-current h-4 w-4" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 20 20">
									<path d="M9.293 12.95l.707.707L15.657 8l-1.414-1.414L10 10.828 5.757 6.586 4.343 8z"/>
								</svg>
							</div>
						</div>
					</div>
				</div>

				<div :class="`${$color('blocks')}  px-5 pb-1 pt-5`">
					<div class="mb-2">
						<label class="block  text-sm font-bold mb-2" for="">
							Description
						</label>
						<input-field
							:value.sync="form.description"
							:errors="errors.description"
							type="textarea"
							placeholder="Description"
						/>
					</div>
				</div>
			</div>
		</div>
		<div class="w-full mt-5 p-5">
			<h2 class="text-2xl pt-5">
				Checkpoints
				<img v-if="!isCreate"
						@click="addCheckpoint"
						class="inline-block cursor-pointer checkpoint-add"
						src="@/assets/img/document-add.svg" alt="">
			</h2>
			<div :class="`${$color('blocks')} rounded mt-5 p-5`" :key="checkpointUpdateKey">
				<div class="mb-2" v-for="(checkpoint, v) in form.checkpoints">
					<div class="flex mb-2">
						<div class="w-full mx-2 relative">
							<span class="absolute right-0 top-0 checkpoint-index">{{ v + 1 }}</span>
							<input
								:class="`pl-10 shadow appearance-none border rounded w-full py-2 px-3 ${$color('input')} ${$color('borderMain')}  leading-tight focus:outline-none focus:shadow-outline `"
								type="text"
								placeholder="Checkpoint content"
								v-model="checkpoint.description"
							>
							<img class="absolute right-0 top-0 checkpoint-delete" @click="deleteCheckpoint(v)"
									src="@/assets/img/remove-red.svg" alt="">
						</div>

						<!-- <p class="text-red-500 text-xs italic">Please type a category name</p> -->
					</div>
					<div>
						<div class="flex">
							<div class="w-6/12 mx-2">
								<the-mask mask="##:##:##"
													:class="`shadow appearance-none border rounded w-full py-2 px-3 ${$color('input')} ${$color('borderMain')}  leading-tight focus:outline-none focus:shadow-outline text-center`"
													type="text"
													placeholder="00:00"
													:value="secondsToStringTime(checkpoint.start)"
								/>
							</div>
							<div class="w-6/12 mx-2">
								<the-mask mask="##:##:##"
													:class="`shadow appearance-none border rounded w-full py-2 px-3 ${$color('input')} ${$color('borderMain')}  leading-tight focus:outline-none focus:shadow-outline text-center`"
													type="text"
													placeholder="00:00"
													:value="secondsToStringTime(checkpoint.end)"
								/>
							</div>
						</div>
					</div>
				</div>
			</div>
		</div>
		<transition name="fade">
			<Alert v-if="showSaveAlert" header="Saved" description="You saved your task"></Alert>
		</transition>
	</div>
</BaseLayout>
